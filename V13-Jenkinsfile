pipeline {
  agent any
  tools {
    maven "M3"
  }
  stages {
    stage('Git CheckOut') {
      steps {
        git branch: 'main', url: 'https://github.com/bennetraja/WebAppForJenkins.git'
      }
    }
    stage('Clean and Install') {
      steps {
        bat 'mvn clean install'
      }
    }
    stage('Package') {
      steps {
        bat 'mvn package'
      }
    }
    stage('Server') {
      steps {
        rtServer(
          id: "Artifactory",
          url: 'http://localhost:8082/artifactory',
          username: 'bennetraja',
          password: 'YourPasswordHere',
          bypassProxy: true,
          timeout: 300
        )
      }
    }
    stage('Upload') {
      steps {
        rtUpload(
          serverId: "Artifactory",
          spec: '''{
          "files": [{
            "pattern": "*.war",
            "target": "bennet-libs-release-local"
          }]
        }''',
      )
    }
  }
  stage('Publish build info') {
    steps {
      rtPublishBuildInfo(
        serverId: "Artifactory"
      )
    }
  }
}
}
